<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Webcam Capture</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }
        video, canvas {
            width: 100%;
            max-width: 600px;
            height: auto;
        }
        footer {
            position: fixed;
            bottom: 0;
            width: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            text-align: center;
            padding: 10px 0;
            display: flex;
            justify-content: space-between;
        }
        .hamburger-menu {
            position: relative;
            display: inline-block;
        }
        .hamburger-menu input {
            display: none;
        }
        .hamburger-menu label {
            cursor: pointer;
            display: block;
            padding: 10px;
            background-color: #444;
            border-radius: 5px;
        }
        .menu-content {
            position: absolute;
            bottom: 100%;
            right: 0;
            background-color: #555;
            border-radius: 5px;
            overflow: hidden;
            max-height: 0;
            transition: max-height 0.3s ease-out;
            white-space: nowrap;
        }
        .hamburger-menu input:checked ~ .menu-content {
            max-height: 500px; /* Adjust as needed */
        }
        .menu-content button, .menu-content input, .menu-content select {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #666;
            border: none;
            color: white;
            cursor: pointer;
        }
        .menu-content input, .menu-content select {
            background-color: #555;
            color: white;
        }
        .webcam-light {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: red;
            position: absolute;
            top: 10px;
            right: 10px;
            display: none;
        }
        .webcam-light.active {
            display: block;
        }
        .chatroom {
            position: fixed;
            top: 10px;
            right: 10px;
            width: 300px;
            max-height: 400px;
            background-color: #333;
            border-radius: 5px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        .chatroom-messages {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
            color: #ff69b4; /* Colorful font color */
        }
        .chatroom-input {
            display: flex;
            border-top: 1px solid #444;
        }
        .chatroom-input input {
            flex: 1;
            padding: 10px;
            border: none;
            background-color: #444;
            color: white;
        }
        .chatroom-input button {
            padding: 10px;
            background-color: #555;
            border: none;
            color: white;
            cursor: pointer;
        }
        .chatroom-input img {
            width: 30px;
            height: 30px;
            cursor: pointer;
            margin-left: 10px;
        }
        .hex-code {
            margin-top: 10px;
            background-color: #222;
            padding: 10px;
            border-radius: 5px;
            color: #00ff00;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="chatroom" id="chatroom">
        <div class="chatroom-messages" id="chatroomMessages"></div>
    </div>

    <h1>Webcam Capture</h1>
    <div class="webcam-light" id="webcamLight"></div>
    <video id="videoElement" autoplay playsinline controls></video>
    <canvas id="canvasElement" style="display: none;"></canvas>
    <img id="photoElement" style="display: none;">
    <div class="hex-code" id="hexCode">Hex Code: #000000</div>

    <footer>
        <div class="chatroom-input">
            <input type="text" id="chatInput" placeholder="Type a message...">
            <button id="sendButton">Send</button>
            <img id="captureToChat" src="https://github.com/eckoln/nextdaily/raw/main/public/logo192.png" alt="Capture to Chat">
        </div>
        <div class="hamburger-menu">
            <input type="checkbox" id="menu-toggle">
            <label for="menu-toggle">â˜°</label>
            <div class="menu-content">
                <button id="startButton">Start</button>
                <button id="stopButton">Stop</button>
                <button id="captureButton">Capture</button>
                <button id="muteButton">Mute</button>
                <button id="unmuteButton">Unmute</button>
                <button id="fullscreenButton">Fullscreen</button>
                <label for="fpsControl">FPS:</label>
                <select id="fpsControl">
                    <option value="30">30 FPS</option>
                    <option value="60">60 FPS</option>
                    <option value="120">120 FPS</option>
                </select>
                <label for="isoControl">ISO:</label>
                <select id="isoControl">
                    <option value="100">100</option>
                    <option value="200">200</option>
                    <option value="400">400</option>
                    <option value="800">800</option>
                    <option value="1600">1600</option>
                    <option value="3200">3200</option>
                </select>
                <button id="lidarButton">Toggle LiDAR</button>
                <label for="lutControl">LUT Presets:</label>
                <select id="lutControl">
                    <option value="none">None</option>
                    <option value="preset1">Preset 1</option>
                    <option value="preset2">Preset 2</option>
                    <option value="preset3">Preset 3</option>
                </select>
                <label for="hdriControl">HDRI:</label>
                <select id="hdriControl">
                    <option value="none">None</option>
                    <option value="hdri1">HDRI 1</option>
                    <option value="hdri2">HDRI 2</option>
                    <option value="hdri3">HDRI 3</option>
                </select>
                <label for="codecControl">Codec:</label>
                <select id="codecControl">
                    <option value="vp8">VP8</option>
                    <option value="vp9">VP9</option>
                    <option value="h264">H.264</option>
                    <option value="av1">AV1</option>
                </select>
                <label for="resolutionControl">Resolution:</label>
                <select id="resolutionControl">
                    <option value="640x480">640x480</</option>
                    <option value="1280x720">1280x720</option>
                    <option value="1920x1080">1920x1080</option>
                    <option value="3840x2160">3840x2160</option>
                </select>
                <button id="shareButton">Share Stream</button>
                <button id="joinButton">Join Stream</button>
            </div>
        </div>
    </footer>

    <script>
        const videoElement = document.getElementById('videoElement');
        const startButton = document.getElementById('startButton');
        const stopButton = document.getElementById('stopButton');
        const captureButton = document.getElementById('captureButton');
        const muteButton = document.getElementById('muteButton');
        const unmuteButton = document.getElementById('unmuteButton');
        const fullscreenButton = document.getElementById('fullscreenButton');
        const fpsControl = document.getElementById('fpsControl');
        const isoControl = document.getElementById('isoControl');
        const lidarButton = document.getElementById('lidarButton');
        const lutControl = document.getElementById('lutControl');
        const hdriControl = document.getElementById('hdriControl');
        const codecControl = document.getElementById('codecControl');
        const resolutionControl = document.getElementById('resolutionControl');
        const shareButton = document.getElementById('shareButton');
        const joinButton = document.getElementById('joinButton');
        const webcamLight = document.getElementById('webcamLight');
        const chatroomMessages = document.getElementById('chatroomMessages');
        const chatInput = document.getElementById('chatInput');
        const sendButton = document.getElementById('sendButton');
        const captureToChat = document.getElementById('captureToChat');
        const hexCode = document.getElementById('hexCode');

        let stream;
        let lidarEnabled = false;

        async function startWebcam() {
            try {
                const resolution = resolutionControl.value.split('x');
                stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        facingMode: 'user',
                        frameRate: { ideal: fpsControl.value },
                        width: { ideal: parseInt(resolution[0]) },
                        height: { ideal: parseInt(resolution[1]) },
                        advanced: [{ iso: isoControl.value }]
                    }
                });
                videoElement.srcObject = stream;
                startButton.disabled = true;
                stopButton.disabled = false;
                captureButton.disabled = false;
                muteButton.disabled = false;
                unmuteButton.disabled = false;
                fullscreenButton.disabled = false;
                webcamLight.classList.add('active');
                updateHexCode();
            } catch (error) {
                console.error('Error accessing webcam:', error);
            }
        }

        function stopWebcam() {
            stream.getTracks().forEach(track => track.stop());
            videoElement.srcObject = null;
            startButton.disabled = false;
            stopButton.disabled = true;
            captureButton.disabled = true;
            muteButton.disabled = true;
            unmuteButton.disabled = true;
            fullscreenButton.disabled = true;
            webcamLight.classList.remove('active');
        }

        function capturePhoto() {
            const canvas = document.getElementById('canvasElement');
            const context = canvas.getContext('2d');
            canvas.width = videoElement.videoWidth;
            canvas.height = videoElement.videoHeight;
            context.drawImage(videoElement, 0, 0, canvas.width, canvas.height);
            const photo = document.getElementById('photoElement');
            photo.src = canvas.toDataURL('image/png');
            photo.style.display = 'block';
            return photo.src;
        }

        function muteVideo() {
            videoElement.muted = true;
        }

        function unmuteVideo() {
            videoElement.muted = false;
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                videoElement.requestFullscreen().catch(err => {
                    alert(`Error attempting to enable full-screen mode: ${err.message} (${err.name})`);
                });
            } else {
                document.exitFullscreen();
            }
        }

        function toggleLiDAR() {
            lidarEnabled = !lidarEnabled;
            if (lidarEnabled) {
                alert('LiDAR enabled');
                // Implement LiDAR functionality here
            } else {
                alert('LiDAR disabled');
                // Disable LiDAR functionality here
            }
        }

        function applyLUT() {
            const selectedLUT = lutControl.value;
            // Implement LUT application logic here
            alert(`LUT applied: ${selectedLUT}`);
        }

        function applyHDRI() {
            const selectedHDRI = hdriControl.value;
            // Implement HDRI application logic here
            alert(`HDRI applied: ${selectedHDRI}`);
        }

        function shareStream() {
            if (navigator.share) {
                navigator.share({
                    title: 'Webcam Stream',
                    text: 'Check out my webcam stream!',
                    url: window.location.href
                }).then(() => {
                    console.log('Stream shared successfully');
                }).catch((error) => {
                    console.error('Error sharing stream:', error);
                });
            } else {
                alert('Web Share API is not supported in your browser.');
            }
        }

        function joinStream() {
            const streamUrl = prompt('Enter the stream URL:');
            if (streamUrl) {
                videoElement.src = streamUrl;
                videoElement.play();
            }
        }

        function sendMessage() {
            const message = chatInput.value;
            if (message.trim()) {
                const messageElement = document.createElement('div');
                messageElement.textContent = message;
                chatroomMessages.appendChild(messageElement);
                chatInput.value = '';
                chatroomMessages.scrollTop = chatroomMessages.scrollHeight;
            }
        }

        function sendCaptureToChat() {
            const captureSrc = capturePhoto();
            const messageElement = document.createElement('div');
            const imgElement = document.createElement('img');
            imgElement.src = captureSrc;
            imgElement.style.width = '100px';
            imgElement.style.height = 'auto';
            messageElement.appendChild(imgElement);
            chatroomMessages.appendChild(messageElement);
            chatroomMessages.scrollTop = chatroomMessages.scrollHeight;
        }

        function updateHexCode() {
            const canvas = document.getElementById('canvasElement');
            const context = canvas.getContext('2d');
            context.drawImage(videoElement, 0, 0, canvas.width, canvas.height);
            const frame = context.getImageData(0, 0, canvas.width, canvas.height);
            const length = frame.data.length;
            let r = 0, g = 0, b = 0;
            for (let i = 0; i < length; i += 4) {
                r += frame.data[i];
                g += frame.data[i + 1];
                b += frame.data[i + 2];
            }
            r = Math.floor(r / (length / 4));
            g = Math.floor(g / (length / 4));
            b = Math.floor(b / (length / 4));
            const hex = `#${((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1).toUpperCase()}`;
            hexCode.textContent = `Hex Code: ${hex}`;
            requestAnimationFrame(updateHexCode);
        }

        startButton.addEventListener('click', startWebcam);
        stopButton.addEventListener('click', stopWebcam);
        captureButton.addEventListener('click', capturePhoto);
        muteButton.addEventListener('click', muteVideo);
        unmuteButton.addEventListener('click', unmuteVideo);
        fullscreenButton.addEventListener('click', toggleFullscreen);
        lidarButton.addEventListener('click', toggleLiDAR);
        lutControl.addEventListener('change', applyLUT);
        hdriControl.addEventListener('change', applyHDRI);
        shareButton.addEventListener('click', shareStream);
        joinButton.addEventListener('click', joinStream);
        sendButton.addEventListener('click', sendMessage);
        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
        captureToChat.addEventListener('click', sendCaptureToChat);

        stopButton.disabled = true;
        captureButton.disabled = true;
        muteButton.disabled = true;
        unmuteButton.disabled = true;
        fullscreenButton.disabled = true;
    </script>
</body>
</html>





